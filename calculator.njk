---
pagination:
  data: collections.calculatorPages
  size: 1
  alias: calc
permalink: "{{ calc.lang }}/{{ calc.slug }}/index.html"
---
<!DOCTYPE html>
<html lang="{{ calc.lang }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ calc.title | safe }} | {{ site.name }}</title>
    <meta name="description" content="{{ calc.metaDescription | safe }}">
    
    <!-- Google AdSense Verification -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4388136005778314" crossorigin="anonymous"></script>
    
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="{{ site.url }}/{{ calc.lang }}/{{ calc.slug }}/">
    
    <!-- Hreflang for all languages -->
    {%- set calcData = calculators[calc.type] -%}
    {%- for langItem in site.languages %}
    <link rel="alternate" hreflang="{{ langItem.code }}" href="{{ site.url }}/{{ langItem.code }}/{{ calcData.slugs[langItem.code] }}/">
    {%- endfor %}
    <link rel="alternate" hreflang="x-default" href="{{ site.url }}/en/{{ calcData.slugs.en }}/">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ site.url }}/{{ calc.lang }}/{{ calc.slug }}/">
    <meta property="og:title" content="{{ calc.title }}">
    <meta property="og:description" content="{{ calc.metaDescription }}">
    <meta property="og:site_name" content="{{ site.name }}">
    <meta property="og:locale" content="{{ calc.lang }}">
    <meta property="og:image" content="{{ site.url }}/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ calc.title }}">
    <meta name="twitter:description" content="{{ calc.metaDescription }}">
    <meta name="twitter:image" content="{{ site.url }}/assets/images/og-image.png">
    
    <!-- Additional SEO -->
    <meta name="author" content="{{ site.name }}">
    <meta name="generator" content="CalcKit Engine">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/images/logo.png">
    <link rel="apple-touch-icon" href="/assets/images/logo.png">
    
    <!-- Schema.org Calculator -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "{{ calc.title }}",
        "description": "{{ calc.metaDescription }}",
        "url": "{{ site.url }}/{{ calc.lang }}/{{ calc.slug }}/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "{{ calc.config.currency[calc.lang] or 'USD' }}" },
        "inLanguage": "{{ calc.lang }}",
        "featureList": "Calculate {{ calc.config.resultLabel[calc.lang] }}",
        "softwareRequirements": "Modern Web Browser",
        "author": {
            "@type": "Organization",
            "name": "{{ site.name }}",
            "url": "{{ site.url }}",
            "logo": "{{ site.url }}/assets/images/logo.png"
        }
    }
    </script>

    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "{{ site.name }}",
                "item": "{{ site.url }}/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "{{ calc.title }}",
                "item": "{{ site.url }}/{{ calc.lang }}/{{ calc.slug }}/"
            }
        ]
    }
    </script>

    <!-- HowTo Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Calculate {{ calc.config.resultLabel[calc.lang] | default('Results') }} with {{ calc.title }}",
        "description": "{{ calc.metaDescription }}",
        "dateModified": "2026-01-18",
        "estimatedCost": {
            "@type": "MonetaryAmount",
            "currency": "{{ calc.config.currency[calc.lang] | default('USD') }}",
            "value": "0"
        },
        "totalTime": "PT2M",
        "step": [
            {
                "@type": "HowToStep",
                "position": 1,
                "name": "Enter your {{ calc.config.primaryInputLabel[calc.lang] | default('values') }}",
                "text": "Start by entering your primary values such as price, amount, or quantity in the input fields.",
                "url": "{{ site.url }}/{{ calc.lang }}/{{ calc.slug }}/#calculator-container"
            },
            {
                "@type": "HowToStep",
                "position": 2,
                "name": "Adjust additional parameters",
                "text": "Fine-tune your calculation by adjusting rates, terms, and other variables."
            },
            {
                "@type": "HowToStep",
                "position": 3,
                "name": "Review instant results",
                "text": "See your {{ calc.config.resultLabel[calc.lang] | default('results') }} instantly calculated as you type."
            },
            {
                "@type": "HowToStep",
                "position": 4,
                "name": "Analyze the breakdown",
                "text": "Review the detailed breakdown showing all components and costs."
            }
        ],
        "tool": {
            "@type": "HowToTool",
            "name": "{{ site.name }} {{ calc.title }}"
        }{% if calc.stateData or calc.countryData %},
        "areaServed": {
            "@type": "{% if calc.stateData %}State{% else %}Country{% endif %}",
            "name": "{% if calc.stateData %}{{ calc.stateData.name }}{% else %}{{ calc.countryData.name }}{% endif %}"
        }{% endif %}
    }
    </script>

    <!-- FAQ Schema -->
    {%- if calc.faqs and calc.faqs.length > 0 %}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {%- for faq in calc.faqs %}
            {
                "@type": "Question",
                "name": "{{ faq.q }}{% if calc.stateData %} in {{ calc.stateData.name }}{% elif calc.countryData %} {{ calc.countryData.nameLocalized }}{% elif calc.location %} in {{ calc.location.name }}{% endif %}",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "{{ faq.a }} {% if calc.stateData %}This calculator uses {{ calc.stateData.name }}'s actual property tax rate of {{ calc.stateData.mortgage.propertyTaxRate }}% and average insurance of ${{ calc.stateData.mortgage.homeInsurance }}/year.{% elif calc.countryData %}Updated for {{ calc.countryData.nameLocalized }} with typical rates of {{ calc.countryData.mortgage.typicalRate }}% and {{ calc.countryData.mortgage.downPayment }}% down payment.{% elif calc.location %}Use our calculator to estimate costs specifically for {{ calc.location.name }}, {{ calc.location.state }}.{% endif %}"
                }
            }{% if not loop.last or calc.localFaqs %},{% endif %}
            {%- endfor %}
            {%- if calc.localFaqs %}
            {%- for faq in calc.localFaqs %}
            {
                "@type": "Question",
                "name": "{{ faq.q }}",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "{{ faq.a }}"
                }
            }{% if not loop.last %},{% endif %}
            {%- endfor %}
            {%- endif %}
        ]
    }
    </script>
    {%- endif %}

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.analytics.gaId }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ site.analytics.gaId }}');
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/{{ manifest['style.css'] | default('style.css') }}">
    {% include "components/language-redirect.njk" %}
</head>

<body data-calculator-type="{{ calc.type }}">
    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <a href="{% if calc.lang == 'en' %}/{% else %}/{{ calc.lang }}/{% endif %}" class="logo">{{ site.name }}</a>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
        <div class="container">
            <h1>{{ calc.title | safe }}</h1>
            <p>{{ calc.subtitle | safe }}</p>
            <div class="trust-badge">
                <span class="edition-badge">2026 {{ ui.nav[calc.lang].edition | default("Edition") }}</span> ‚Ä¢ <span>‚úì</span> {{ ui.stats.free[calc.lang] | default("Free") }} ‚Ä¢ {{ ui.stats.noSignup[calc.lang] | default("No signup required") }}
            </div>
            
            {# Freshness Signal - Last Updated Badge #}
            <div class="freshness-badge" style="margin-top: 12px; font-size: 12px; color: rgba(255,255,255,0.6);">
                üìÖ {{ ui.footer[calc.lang].lastUpdated | default("Last updated") }}: January 2026
                {%- if calc.stateData %} ‚Ä¢ üìç {{ calc.stateData.name }} {{ ui.localInsights.tips[calc.lang] | default("data") }}{% endif %}
                {%- if calc.countryData %} ‚Ä¢ üìç {{ calc.countryData.nameLocalized }} {{ ui.localInsights.tips[calc.lang] | default("data") }}{% endif %}
            </div>
            
            {# Semantic Long-Tail SEO Content (screen-reader accessible but visually hidden) #}
            <p class="sr-only seo-semantic">
                {%- if calc.stateData %}
                Best {{ calc.config.name[calc.lang] | default("calculator") }} for {{ calc.stateData.name }} residents. Calculate your {{ calc.config.resultLabel[calc.lang] | default("results") }} with {{ calc.stateData.name }}-specific property tax rates ({{ calc.stateData.mortgage.propertyTaxRate }}%) and insurance costs. Updated for 2026 with current {{ calc.stateData.name }} real estate market data.
                {%- elif calc.countryData %}
                {{ calc.config.name[calc.lang] | default("Calculator") }} {{ ui.localInsights.title[calc.lang] | default("for") }} {{ calc.countryData.nameLocalized }}. {{ ui.localInsights.tips[calc.lang] | default("Local tips") }} {{ calc.countryData.nameLocalized }} 2026. {{ calc.countryData.currencySymbol }} {{ calc.countryData.mortgage.typicalRate }}% {{ ui.localInsights.typicalRate[calc.lang] | default("typical rate") }}.
                {%- else %}
                Free online {{ calc.config.name[calc.lang] | default("calculator") }} 2026. {{ ui.nav[calc.lang].instantResults | default("Instant results") }}. {{ ui.stats.noSignup[calc.lang] | default("No signup required") }}. Calculate {{ calc.config.resultLabel[calc.lang] | default("results") }} instantly.
                {%- endif %}
            </p>
        </div>
    </section>



    <!-- Calculator -->
    <section class="calculator-section">
        <div class="container">
            <div class="calculator-wrapper">
                <div id="calculator-container"></div>
            </div>
        </div>
    </section>

    {% if site.analytics.adSenseId %}
    <!-- Ad Slot: Below Calculator -->
    <div class="container ad-container" style="margin: 2rem auto; text-align: center;">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="{{ site.analytics.adSenseId }}"
             data-ad-slot="YOUR_DESIRED_SLOT_ID_1"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>
    {% endif %}

    {# Local Market Insights Section - for US States and Countries #}
    {%- if calc.localTips and calc.localTips.length > 0 %}
    <section class="local-insights-section" style="padding: 40px 0;">
        <div class="container">
            <div class="local-insights-card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(168, 85, 247, 0.08) 100%); border-radius: 20px; padding: 32px 40px; border: 1px solid rgba(99, 102, 241, 0.15);">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                    <span style="font-size: 28px;">
                        {%- if calc.stateData %}üá∫üá∏{% elif calc.countryData %}üåç{% endif %}
                    </span>
                    <h2 style="font-size: 24px; font-weight: 700; margin: 0; background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {%- if calc.stateData %}
                            {{ calc.stateData.name }} Market Insights
                        {%- elif calc.countryData %}
                            {{ calc.countryData.nameLocalized }} - {{ ui.localInsights.title[calc.lang] | default("Local Market Insights") }}
                        {%- endif %}
                    </h2>
                </div>

                {# State-specific data display #}
                {%- if calc.stateData and calc.stateData.mortgage %}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 28px;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">Median Home Price</div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary-light);">${{ calc.stateData.mortgage.medianPrice | default(0) | round | replace("(\d)(?=(\d{3})+(?!\d))", "$1,") }}</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">Property Tax Rate</div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary-light);">{{ calc.stateData.mortgage.propertyTaxRate }}%</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">Avg. Home Insurance</div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary-light);">${{ calc.stateData.mortgage.homeInsurance }}/yr</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">State Income Tax</div>
                        <div style="font-size: 24px; font-weight: 700; color: {% if calc.stateData.mortgage.hasStateIncomeTax %}var(--text-muted){% else %}#10b981{% endif %};">
                            {%- if calc.stateData.mortgage.hasStateIncomeTax %}Yes{% else %}None ‚úì{% endif %}
                        </div>
                    </div>
                </div>
                {%- endif %}

                {# Country-specific data display #}
                {%- if calc.countryData and calc.countryData.mortgage %}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 20px; margin-bottom: 28px;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">{{ ui.localInsights.medianPrice[calc.lang] | default("Median Price") }}</div>
                        <div style="font-size: 22px; font-weight: 700; color: var(--primary-light);">{{ calc.countryData.currencySymbol }}{{ calc.countryData.mortgage.medianPrice | default(0) }}</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">{{ ui.localInsights.typicalRate[calc.lang] | default("Typical Rate") }}</div>
                        <div style="font-size: 22px; font-weight: 700; color: var(--primary-light);">{{ calc.countryData.mortgage.typicalRate }}%</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">{{ ui.localInsights.loanTerm[calc.lang] | default("Loan Term") }}</div>
                        <div style="font-size: 22px; font-weight: 700; color: var(--primary-light);">{{ calc.countryData.mortgage.typicalTerm }} {{ ui.localInsights.years[calc.lang] | default("years") }}</div>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="color: var(--text-muted); font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">{{ ui.localInsights.downPayment[calc.lang] | default("Down Payment") }}</div>
                        <div style="font-size: 22px; font-weight: 700; color: var(--primary-light);">{{ calc.countryData.mortgage.downPayment }}%</div>
                    </div>
                </div>
                {%- endif %}

                {# Tips list #}
                <div style="margin-top: 20px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px; color: var(--text);">
                        üí° {%- if calc.stateData %}Local Tips{% else %}{{ ui.localInsights.tips[calc.lang] | default("Local Tips") }}{% endif %}
                    </h3>
                    <ul style="list-style: none; padding: 0; margin: 0; display: grid; gap: 12px;">
                        {%- for tip in calc.localTips %}
                        <li style="display: flex; align-items: flex-start; gap: 10px; padding: 12px 16px; background: rgba(255, 255, 255, 0.03); border-radius: 10px; border-left: 3px solid var(--primary);">
                            <span style="color: #10b981; flex-shrink: 0;">‚úì</span>
                            <span style="color: var(--text-muted); font-size: 14px; line-height: 1.6;">{{ tip }}</span>
                        </li>
                        {%- endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </section>
    {%- endif %}

    <!-- Contextual Content -->
    {%- if calc.content %}
    <section class="content-section">
        <div class="container">
            <div class="seo-content">
                {{ calc.content | safe }}
            </div>
        </div>
    </section>
    {%- endif %}

    <!-- FAQ Section -->
    {%- if calc.faqs and calc.faqs.length > 0 %}
    <section class="faq-section">
        <div class="container">
            <h2>{{ ui.faq[calc.lang] }}{% if calc.stateData %} - {{ calc.stateData.name }}{% elif calc.countryData %} - {{ calc.countryData.nameLocalized }}{% endif %}</h2>
            
            {# Local FAQs First (if available) #}
            {%- if calc.localFaqs %}
            <div class="local-faqs-badge" style="margin-bottom: 20px; padding: 12px 16px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1)); border-radius: 12px; border-left: 4px solid #6366f1;">
                <span style="font-size: 16px;">üìç</span> <strong style="color: var(--primary-light);">{% if calc.stateData %}{{ calc.stateData.name }}{% elif calc.countryData %}{{ calc.countryData.nameLocalized }}{% endif %}-specific questions</strong>
            </div>
            {%- for faq in calc.localFaqs %}
            <div class="faq-item local-faq">
                <div class="faq-question">
                    {{ faq.q }}
                    <span class="faq-icon">+</span>
                </div>
                <div class="faq-answer">
                    <p>{{ faq.a }}</p>
                </div>
            </div>
            {%- endfor %}
            {%- endif %}
            
            {# Generic FAQs #}
            {%- for faq in calc.faqs %}
            <div class="faq-item">
                <div class="faq-question">
                    {{ faq.q }}{% if calc.stateData %} in {{ calc.stateData.name }}{% elif calc.countryData %} {{ calc.countryData.nameLocalized }}{% elif calc.location %} in {{ calc.location.name }}{% endif %}
                    <span class="faq-icon">+</span>
                </div>
                <div class="faq-answer">
                    <p>{{ faq.a }}{% if calc.stateData %} This calculator uses {{ calc.stateData.name }}'s actual property tax rate of {{ calc.stateData.mortgage.propertyTaxRate }}%.{% elif calc.countryData %} Updated for {{ calc.countryData.nameLocalized }} with typical rates of {{ calc.countryData.mortgage.typicalRate }}%.{% elif calc.location %} Use our calculator to estimate costs specifically for {{ calc.location.name }}, {{ calc.location.state }}.{% endif %}</p>
                </div>
            </div>
            {%- endfor %}
        </div>
    </section>
    {%- endif %}

    <!-- WordPress Plugin CTA -->
    <div class="container">
        {% include "partials/plugin-cta.njk" %}
    </div>

    <!-- Related Tools -->
    <section class="content-section" style="padding-top: 0;">
        <div class="container">
            <span class="section-tag">{{ ui.footer[calc.lang].otherTools | default("Recommended Tools") }}</span>
            <h2>{{ ui.footer[calc.lang].relatedTitle | default("Explore More Calculators") }}</h2>
            <div class="related-grid">
                {%- set count = 0 -%}
                {%- for calcType, calcInfo in calculators -%}
                {%- if calcType != calc.type and count < 3 -%}
                <a href="/{{ calc.lang }}/{{ calcInfo.slugs[calc.lang] }}/" class="related-card">
                    <h3>{{ calcInfo.titles[calc.lang] }}</h3>
                    <p>{{ calcInfo.subtitles[calc.lang] }}</p>
                </a>
                {%- set count = count + 1 -%}
                {%- endif -%}
                {%- endfor -%}
            </div>
        </div>
    </section>

    {% if site.analytics.adSenseId %}
    <!-- Ad Slot: Before Footer -->
    <div class="container ad-container" style="margin: 2rem auto; text-align: center;">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="{{ site.analytics.adSenseId }}"
             data-ad-slot="YOUR_DESIRED_SLOT_ID_2"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>
    {% endif %}

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <ul class="footer-links">
                {%- for calcType, calcInfo in calculators %}
                {%- if calcType != calc.type %}
                <li><a href="/{{ calc.lang }}/{{ calcInfo.slugs[calc.lang] }}/">{{ calcInfo.titles[calc.lang] }}</a></li>
                {%- endif %}
                {%- endfor %}
                <li><a href="{% if calc.lang == 'en' %}/{% else %}/{{ calc.lang }}/{% endif %}privacy.html">{{ ui.footer[calc.lang].privacy | default("Privacy Policy") }}</a></li>
                <li><a href="{% if calc.lang == 'en' %}/{% else %}/{{ calc.lang }}/{% endif %}terms.html">{{ ui.footer[calc.lang].terms | default("Terms of Service") }}</a></li>
            </ul>
            <div class="footer-lang" style="margin-top: 16px; display: flex; justify-content: center; gap: 12px; align-items: center;">
                <span style="color: var(--text-muted); font-size: 13px;">üåê</span>
                {%- for langItem in site.languages %}
                <a href="/{{ langItem.code }}/{{ calculators[calc.type].slugs[langItem.code] }}/" 
                   onclick="localStorage.setItem('preferred_lang', '{{ langItem.code }}')"
                   style="color: {% if langItem.code == calc.lang %}var(--primary-light){% else %}var(--text-muted){% endif %}; font-size: 12px; text-decoration: none; padding: 4px 8px; border-radius: 4px; {% if langItem.code == calc.lang %}background: rgba(99, 102, 241, 0.15);{% endif %}">{{ langItem.code | upper }}</a>
                {%- endfor %}
            </div>
            <p>¬© {{ site.year }} {{ site.name }}. {{ ui.footer[calc.lang].copyright | default("All rights reserved") }}.</p>
        </div>
    </footer>



    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const calculator = document.querySelector('calckit-calculator');
            if (calculator) {
                calculator.addEventListener('request-pdf', (e) => {
                    console.log('PDF requested but not available on this site.');
                    alert("{{ ui.alerts.pdfNotAvailable[calc.lang] | default('PDF reports are not available on this site yet.') }}");
                });
            }
        });
    </script>

    
    <!-- Calculator Engine -->
    <script src="/assets/js/{{ manifest['calculator.js'] | default('calculator.js') }}"></script>
    
    <!-- Analytics Tracking -->
    <script src="/assets/js/{{ manifest['analytics.js'] | default('analytics.js') }}"></script>
    
    <script>
        // Build config for this specific language
        const calcConfig = {
            type: "{{ calc.type }}",
            title: "{{ calc.title | safe }}",
            subtitle: "{{ calc.subtitle | safe }}",
            currency: "{{ calc.config.currency[calc.lang] }}",
            locale: "{{ calc.config.locale[calc.lang] }}",
            fields: [
                {%- for field in calc.config.fields %}
                {
                    id: "{{ field.id }}",
                    type: "{{ field.type }}",
                    label: "{{ field.label[calc.lang] | safe }}",
                    default: {{ field.default }}{% if field.type != 'select' %},
                    max: {{ field.max }},
                    step: {{ field.step }}{% endif %}{% if field.help %},
                    help: "{{ field.help[calc.lang] | safe }}"{% endif %}{% if field.description %},
                    description: "{{ field.description[calc.lang] | safe }}"{% endif %}{% if field.toggle %},
                    toggle: {
                        target: "{{ field.toggle.target }}",
                        label: "{{ field.toggle.label[calc.lang] | safe }}"
                    }{% endif %}{% if field.hidden %},
                    hidden: {{ field.hidden }}{% endif %}
                    {%- if field.options %},
                    options: [
                        {%- for opt in field.options %}
                        { value: {{ opt.value }}, label: "{{ opt.label[calc.lang] | safe }}" }{% if not loop.last %},{% endif %}
                        {%- endfor %}
                    ]
                    {%- endif %}
                }{% if not loop.last %},{% endif %}
                {%- endfor %}
            ],
            formula: "{{ calc.config.formula }}",
            resultLabel: "{{ calc.config.resultLabel[calc.lang] | safe }}",
            breakdown: [
                {%- for item in calc.config.breakdown %}
                { label: "{{ item.label[calc.lang] | safe }}", formula: "{{ item.formula }}" }{% if not loop.last %},{% endif %}
                {%- endfor %}
            ]{% if calc.config.notices %},
            notices: [
                {%- for notice in calc.config.notices %}
                {
                    message: "{{ notice.message[calc.lang] | safe }}",
                    condition: "{{ notice.condition }}",
                    type: "{{ notice.type }}"
                }{% if not loop.last %},{% endif %}
                {%- endfor %}
            ]
            {% endif %}
        };

        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('calculator-container');
            const wrapper = document.createElement('div');
            wrapper.className = 'calckit-calculator';
            wrapper.dataset.theme = 'dark';
            
            // Build config for this specific language
            const initialConfig = JSON.stringify(calcConfig);
            wrapper.dataset.config = initialConfig;
            
            container.appendChild(wrapper);
            wrapper.appendChild(document.createElement('calckit-calculator'));
        });

        // FAQ Accordion
        document.querySelectorAll('.faq-question').forEach(q => {
            q.addEventListener('click', () => q.parentElement.classList.toggle('open'));
        });
    </script>
    
    <!-- Geo-Detection: Automatically show local market insights based on user location -->
    <script src="/assets/js/geo-detect.js" defer></script>
    
    {% include "components/cookie-banner.njk" %}
</body>
</html>
